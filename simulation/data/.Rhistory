clusters-<read.table("all.faa.nr.clstr.summary",header=T)
clusters<-read.table("all.faa.nr.clstr.summary",header=T)
head(clusters)
sum(clusters$OKUS)
sum(clusters$MGRAST)
sum(clusters$IMG)
table(clusters)
?table
table(clusters[1:100])
table(clusters[1:100],)
clusters[1:100,]
table(clusters[1:100],)
table(clusters[1:100,])
venn.plot <- draw.triple.venn(
area1 = 65,
area2 = 75,
area3 = 85,
n12 = 35,
n23 = 15,
n13 = 25,
n123 = 5,
category = c("First", "Second", "Third"),
fill = c("blue", "red", "green"),
lty = "blank",cex = 2,
cat.cex = 2,
cat.col = c("blue", "red", "green")
);
library(VennDiagram)
venn.plot <- draw.triple.venn(
area1 = 65,
area2 = 75,
area3 = 85,
n12 = 35,
n23 = 15,
n13 = 25,
n123 = 5,
category = c("First", "Second", "Third"),
fill = c("blue", "red", "green"),
lty = "blank",cex = 2,
cat.cex = 2,
cat.col = c("blue", "red", "green")
);
?draw.triple.venn
venn.plot <- draw.triple.venn(65, 75, 85, 35, 15, 25, 5, c("First", "Second", "Third"));
venn.plot <- draw.triple.venn(
area1 = 65,
area2 = 75,
area3 = 85,
n12 = 35,
n23 = 15,
n13 = 25,
n123 = 5,
category = c("First", "Second", "Third"),
fill = c("blue", "red", "green"),
lty = "blank",
cex = 2,
cat.cex = 2,
cat.col = c("blue", "red", "green")
);
venn.plot <- draw.triple.venn(20, 40, 60, 0, 0, 0, 0, c("First", "Second", "Third"), sep.dist = 0.1, rotation.degree = 30);
grid.draw(venn.plot);
grid.draw(venn.plot);
venn.plot <- draw.triple.venn(20, 40, 60, 0, 0, 0, 0, c("First", "Second", "Third"), sep.dist = 0.1, rotation.degree = 30);
venn.plot <- draw.triple.venn(
area1 = 65,
area2 = 75,
area3 = 85,
n12 = 35,
n23 = 15,
n13 = 25,
n123 = 5,
category = c("First", "Second", "Third"),
fill = c("blue", "red", "green"),
lty = "blank",
cex = 2,
cat.cex = 2,
cat.col = c("blue", "red", "green")
);
venn.plot <- draw.triple.venn(65, 75, 85, 35, 15, 25, 5, c("First", "Second", "Third"));
grid.draw(venn.plot);
grid.draw(venn.plot);
clusters[]
dim(clusters[clusters$OKUS>0,])
sum(clusters[clusters$OKUS>0,])
sum(clusters$OKUS)
sum(clusters$MGRAST)
sum(clusters$IMG)
venn.plot <- draw.triple.venn(area1=2388263,area2=1834725,area3=1984620,n12=0,n23=0,n13=0,n123=0,category=c("OKUS","MGRAST","IMG"),fill = c("blue", "red", "green"),lty = "blank",cex = 2,cat.cex = 2,cat.col = c("blue", "red", "green"));
venn.plot <- draw.triple.venn(area1=2388263,area2=1834725,area3=1984620,n12=0,n23=0,n13=0,n123=0,category=c("OKUS","MGRAST","IMG"),fill = c("blue", "red", "green"),lty = "blank",cex = 2,cat.cex = 2,cat.col = c("blue", "red", "green"));
head(clusters[clusters$OKUS>0 && clusters$MGRAST>0,])
head(clusters[clusters$OKUS>0 & clusters$MGRAST>0,])
head(clusters[clusters$OKUS>0 & clusters$MGRAST>0 & clusters$IMG==0,])
dim(clusters[clusters$OKUS>0 & clusters$MGRAST>0 & clusters$IMG==0,])
dim(clusters[clusters$OKUS>0 & clusters$MGRAST==0 & clusters$IMG==0,])
dim(clusters[clusters$OKUS>0 & clusters$MGRAST==0 & clusters$IMG>0,])
dim(clusters[clusters$OKUS>0 & clusters$MGRAST==0 & clusters$IMG==0,])
dim(clusters[clusters$OKUS>0,)
dim(clusters[clusters$OKUS>0,])
dim(clusters[clusters$MGRAST>0,])
dim(clusters[clusters$IMG>0,])
dim(clusters)
venn.plot <- draw.triple.venn(area1=2265221,area2=1827822,area3=1959475,n12=0,n23=0,n13=0,n123=0,category=c("OKUS","MGRAST","IMG"),fill = c("blue", "red", "green"),lty = "blank",cex = 2,cat.cex = 2,cat.col = c("blue", "red", "green"));
venn.plot <- draw.triple.venn(area1=2265221,area2=1827822,area3=1959475,n12=0,n23=0,n13=0,n123=0,category=c("OKUS","MGRAST","IMG"),fill = c("blue", "red", "green"),lty = "blank",cex = 2,cat.cex = 2,cat.col = c("blue", "red", "green"));
dim(clusters[clusters$OKUS>0 & clusters$MGRAST>0 & clusters$IMG>0,])
dim(clusters[clusters$OKUS>0 & clusters$MGRAST>0 & clusters$IMG==0,])
dim(clusters[clusters$OKUS==0 & clusters$MGRAST>0 & clusters$IMG>0,])
dim(clusters[clusters$OKUS>0 & clusters$MGRAST==0 & clusters$IMG>0,])
venn.plot <- draw.triple.venn(area1=2265221,area2=1827822,area3=1959475,n12=89797,n23=25847,n13=1178752,n123=492115,category=c("OKUS","MGRAST","IMG"),fill = c("blue", "red", "green"),lty = "blank",cex = 2,cat.cex = 2,cat.col = c("blue", "red", "green"));
dim(clusters[clusters$OKUS>0 & clusters$MGRAST>0 & clusters$IMG>0,])
dim(clusters[clusters$OKUS>0 & clusters$MGRAST>0,])
dim(clusters[clusters$MGRAST>0 & clusters$IMG>0,])
dim(clusters[clusters$OKUS>0 & clusters$IMG>0,])
venn.plot <- draw.triple.venn(area1=2265221,area2=1827822,area3=1959475,n12=581912,n23=517962,n13=1670867,n123=492115,category=c("OKUS","MGRAST","IMG"),fill = c("blue", "red", "green"),lty = "blank",cex = 2,cat.cex = 2,cat.col = c("blue", "red", "green"));
rm('clusters')
ls()
rm('venn.plot')
ls()
clusters-<read.table("all.faa.nr.clstr.summary",header=T)
clusters<-read.table("all.faa.nr.clstr.summary",header=T)
dim(clusters)
dim(clusters[clusters$OKUS>0,])
dim(clusters[clusters$MGRAST>0,])
dim(clusters[clusters$IMG>0,])
dim(clusters[clusters$OKUS>0 & clusters$MGRAST>0 & clusters$IMG>0,])
dim(clusters[clusters$OKUS>0 & clusters$MGRAST>0,])
dim(clusters[clusters$MGRAST>0 & clusters$IMG>0,])
dim(clusters[clusters$OKUS>0 & clusters$IMG>0,])
venn.plot <- draw.triple.venn(area1=2264210,area2=1827960,area3=1980274,n12=581581,n23=518986,n13=1676369,n123=492870,category=c("OKUS","MGRAST","IMG"),fill = c("blue", "red", "green"),lty = "blank",cex = 2,cat.cex = 2,cat.col = c("blue", "red", "green"));
q()
ls()
vnee.p
venn.plot
plot(venn.plot)
rm(venn.plot)
rm(clusters)
ls()
x=c(5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100)
y=c(6,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8)
z=c(15546,19044,21159,22789,23935,24978,25863,26653,27352,28008,28545,29103,29560,30018,30415,30796,31152,31496,31807,32131)
w=c(15540,19037,21152,22782,23928,24971,25856,26646,27345,28001,28538,29096,29553,30011,30407,30788,31144,31488,31799,32123)
m=max(0,32,32)
n=min(0,15,15)
plot(x,z/1000,xlab='percent of total reads',ylab='Number of splicing junctions (x1000)',type='o',col='blue',ylim=c(n,m))
points(x,y/1000,type='o',col='red')
points(x,w/1000,type='o',col='green')
legend(5,32, legend=c("All junctions","known junctions", "novel junctions"),col=c("blue","red","green"),lwd=1,pch=1)
x=c(5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100)
y=c(10776,12388,13137,13660,13964,14224,14415,14561,14730,14853,14948,15047,15131,15214,15275,15353,15413,15459,15517,15571)
z=c(15569,19072,21148,22768,23969,25021,25918,26657,27359,27971,28508,29051,29530,29977,30394,30788,31157,31481,31814,32131)
w=c(4793,6684,8011,9108,10005,10797,11503,12096,12629,13118,13560,14004,14399,14763,15119,15435,15744,16022,16297,16560)
m=max(15,32,16)
n=min(10,15,4)
plot(x,z/1000,xlab='percent of total reads',ylab='Number of splicing junctions (x1000)',type='o',col='blue',ylim=c(n,m))
points(x,y/1000,type='o',col='red')
points(x,w/1000,type='o',col='green')
legend(5,32, legend=c("All junctions","known junctions", "novel junctions"),col=c("blue","red","green"),lwd=1,pch=1)
library(edgeR)
library(EdgeR)
source("http://bioconductor.org/biocLite.R")
library(ggplot2)
setwd("/data2/Projects/ploidyNGS/simulation//data")
data<-read.table(gzfile("table2plotPloidy_Ploidy2_Heter0.001_100.gz"))
head(data)
ggplot(data,aes(x=V4,fill=V3))+geom_histogram(binwidth = 0.5)
ggplot(data,aes(x=V4,fill=V3))+geom_histogram(binwidth = 0.5) + scale_x_continuous(limits=c(1,100))
ggplot(data,aes(x=V4,fill=V3))+geom_histogram(binwidth = 0.5)
ggplot(data,aes(x=V4,fill=V3))+geom_histogram(binwidth = 0.5) + scale_x_continuous(limits=c(1,100))
ggplot(data,aes(x=V4,fill=V3))+geom_histogram(binwidth = 0.5) + scale_x_continuous(limits=c(0,100))
ggplot(data,aes(x=V4,fill=V3))+geom_histogram(binwidth = 0.5) + scale_x_continuous(limits=c(0.5,100))
ggplot(data,aes(x=V4,fill=V3))+geom_histogram(binwidth = 0.5) + scale_x_continuous(limits=c(0.01,100))
ggplot(data,aes(x=V4,fill=V3))+geom_histogram(binwidth = 0.5) + scale_x_continuous(limits=c(5,95))
ggplot(data[which(data$V3 %in% c('FirstFreq','SecondFreq')),],aes(x=V4,fill=V3))+geom_histogram(binwidth = 0.5) + scale_x_continuous(limits=c(5,95))
?hist
